<div class="appointments-page">
  <!-- Header con título y botón volver -->
  <div class="page-header">
    <button class="back-button" routerLink="/apps/farmer/appointments">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span>Volver</span>
    </button>
    <h1 class="page-title">Historial de Citas</h1>
    <div class="spacer"></div>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading" class="loading-state">
    <p>Cargando historial...</p>
  </div>

  <!-- Grid de citas pasadas (2 por fila) -->
  <ng-container *ngIf="!loading && history.length; else noHistory">
    <div class="appointments-grid">
      <div
        class="appointment-card"
        *ngFor="let appt of history"
        [routerLink]="['/apps/farmer/appointments/review', appt.id]"
      >
        <!-- Foto del asesor -->
        <img
          [src]="appt?.advisorPhoto || 'assets/images/profile/user-1.jpg'"
          class="advisor-photo"
          alt="Foto de {{ appt?.advisorName }}"
        />

        <!-- Información -->
        <div class="appointment-details">
          <h3 class="advisor-name">{{ appt?.advisorName }}</h3>
          <div class="divider-line"></div>
          <p class="appointment-date">
            {{ formatDate(appt.scheduledDate) }}
          </p>
          <p class="appointment-time">
            {{ formatTime(appt.startTime, appt.endTime) }}
          </p>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- Empty state -->
  <ng-template #noHistory>
    <div class="empty-state">
      <p>No tienes citas pasadas.</p>
    </div>
  </ng-template>
</div>
