<div *ngIf="!loading()">
  <!-- Botón de volver usando plantilla -->
  <mat-card class="cardWithShadow m-b-16">
    <mat-card-content class="p-16">
      <button mat-button (click)="goBack()" class="d-flex align-items-center">
        <i-tabler name="arrow-left" class="icon-20 m-r-8"></i-tabler>
        Volver
      </button>
    </mat-card-content>
  </mat-card>

  <!-- Card principal del detail -->
  <mat-card class="cardWithShadow">
    <mat-card-content class="p-24">
      <div class="row">
        <!-- Columna izquierda: Foto y nombre del productor -->
        <div class="col-md-4 text-center m-b-24">
          <img 
            [src]="farmerPhoto()" 
            class="rounded-circle border p-5" 
            width="120"
            [alt]="farmerName()" 
          />
          <h3 class="m-t-16 m-b-0">{{ farmerName() }}</h3>
        </div>

        <!-- Columna derecha: Información de la cita -->
        <div class="col-md-8">
          <!-- Fecha programada -->
          <div class="m-b-20">
            <h5 class="text-muted f-s-14 m-b-8">Fecha programada</h5>
            <p class="m-b-0 f-s-16">
              {{ scheduledDate() | date: 'd \'de\' MMMM \'de\' yyyy' : '' : 'es-ES' }}, {{ startTime() }} - {{ endTime() }}
            </p>
          </div>

          <!-- Link de videoconferencia -->
          <div class="m-b-20">
            <h5 class="text-muted f-s-14 m-b-8">Link de la videoconferencia</h5>
            <a [href]="meetingUrl()" target="_blank" class="text-primary f-s-16">
              {{ meetingUrl() }}
            </a>
          </div>

          <!-- Comentario del usuario -->
          <div class="m-b-24">
            <h5 class="text-muted f-s-14 m-b-8">Comentario brindado por el usuario</h5>
            <p class="m-b-0 f-s-16">
              {{ message() }}
            </p>
          </div>

          <!-- Botones de acción -->
          <div class="d-flex gap-12">
            <button mat-flat-button color="warn" (click)="openCancelModal()">
              <i-tabler name="x" class="icon-18 m-r-8"></i-tabler>
              Cancelar Cita
            </button>
          </div>

          <!-- Mensaje de error -->
          <div class="alert alert-danger m-t-16" *ngIf="errorMessage()">
            {{ errorMessage() }}
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>

<!-- Loading -->
<mat-card class="cardWithShadow" *ngIf="loading()">
  <mat-card-content class="text-center p-y-32">
    <mat-progress-spinner mode="indeterminate" diameter="36"></mat-progress-spinner>
    <div class="m-t-16">Cargando...</div>
  </mat-card-content>
</mat-card>
